{"paragraphs":[{"text":"println(sc.version)\nprintln(spark.version)","user":"anonymous","dateUpdated":"2025-04-24T11:29:19-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"2.4.8\r\n2.4.8\r\n"}]},"apps":[],"jobName":"paragraph_1744871547797_270183924","id":"20250417-023227_1742299553","dateCreated":"2025-04-17T02:32:27-0400","dateStarted":"2025-04-24T11:29:19-0400","dateFinished":"2025-04-24T11:29:47-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:352"},{"text":"import com.mongodb.spark._\r\nimport com.mongodb.spark.config._\r\nimport org.bson.Document","user":"anonymous","dateUpdated":"2025-04-24T11:29:47-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.mongodb.spark._\r\nimport com.mongodb.spark.config._\r\nimport org.bson.Document\n"}]},"apps":[],"jobName":"paragraph_1744871611658_304493550","id":"20250417-023331_2006994387","dateCreated":"2025-04-17T02:33:31-0400","dateStarted":"2025-04-24T11:29:48-0400","dateFinished":"2025-04-24T11:29:48-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:353"},{"text":"//Using RDDs\r\n//https://docs.mongodb.com/spark-connector/current/scala/read-from-mongodb/\r\nval mongodb_rdd = sc.loadFromMongoDB(ReadConfig(Map(\"uri\" ->\r\n\"mongodb://127.0.0.1:27018/sampleDataset.crimeData\")))","user":"anonymous","dateUpdated":"2025-04-24T11:29:48-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"mongodb_rdd: com.mongodb.spark.rdd.MongoRDD[org.bson.Document] = MongoRDD[0] at RDD at MongoRDD.scala:51\n"}]},"apps":[],"jobName":"paragraph_1744871611498_2137328136","id":"20250417-023331_80769944","dateCreated":"2025-04-17T02:33:31-0400","dateStarted":"2025-04-24T11:29:48-0400","dateFinished":"2025-04-24T11:29:51-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:354"},{"text":"//mongodb_rdd.take(4).foreach(println)\r\nprintln(mongodb_rdd.count)\r\nprintln(mongodb_rdd.first.toJson)","user":"anonymous","dateUpdated":"2025-04-24T11:31:58-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1005199\r\n{\"_id\": {\"$oid\": \"6800a2a5d4591795ac54cee5\"}, \"DR_NO\": 190326475, \"Date Rptd\": \"03/01/2020 12:00:00 AM\", \"DATE OCC\": \"03/01/2020 12:00:00 AM\", \"TIME OCC\": 2130, \"AREA\": 7, \"AREA NAME\": \"Wilshire\", \"Rpt Dist No\": 784, \"Part 1-2\": 1, \"Crm Cd\": 510, \"Crm Cd Desc\": \"VEHICLE - STOLEN\", \"Vict Age\": 0, \"Vict Sex\": \"M\", \"Vict Descent\": \"O\", \"Premis Cd\": 101, \"Premis Desc\": \"STREET\", \"Status\": \"AA\", \"Status Desc\": \"Adult Arrest\", \"Crm Cd 1\": 510, \"Crm Cd 2\": 998, \"LOCATION\": \"1900 S  LONGWOOD                     AV\", \"LAT\": 34.0375, \"LON\": -118.3506}\r\n"}]},"apps":[],"jobName":"paragraph_1744871611297_1258170948","id":"20250417-023331_1902642242","dateCreated":"2025-04-17T02:33:31-0400","dateStarted":"2025-04-24T11:31:58-0400","dateFinished":"2025-04-24T11:32:33-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:355"},{"text":"// Create a DataFrame from the MongoDB RDD with column name cleanup\r\nval mongoDF = mongodb_rdd.toDF()\r\n\r\n// Rename problematic columns to valid names\r\nval renamedDF = mongoDF.columns.foldLeft(mongoDF) { (df, colName) =>\r\n  // Replace spaces and other invalid characters with underscores\r\n  val newColName = colName.replaceAll(\"[ ,;{}()\\n\\t=]\", \"_\")\r\n  df.withColumnRenamed(colName, newColName)\r\n}\r\n\r\n// Write to Parquet format with the specified path\r\nrenamedDF.write\r\n  .parquet(\"C:/Users/gmuece552-001/mongodb_parquet\")\r\n\r\n// To verify the conversion worked\r\nval df = spark.read.parquet(\"C:/Users/gmuece552-001/mongodb_parquet\")\r\ndf.show(5)  // Show first 5 rows","user":"anonymous","dateUpdated":"2025-04-24T11:32:04-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----------+------+--------+--------+--------+--------------------+------------+--------------------+---------+--------------------+-------+--------------------+---------+--------------------+--------+---------+--------------------+-----------+------+------------+--------+--------+------------+--------+--------------------+--------------+--------------------+\n|AREA|  AREA_NAME|Crm_Cd|Crm_Cd_1|Crm_Cd_2|Crm_Cd_3|         Crm_Cd_Desc|Cross_Street|            DATE_OCC|    DR_NO|           Date_Rptd|    LAT|            LOCATION|      LON|             Mocodes|Part_1-2|Premis_Cd|         Premis_Desc|Rpt_Dist_No|Status| Status_Desc|TIME_OCC|Vict_Age|Vict_Descent|Vict_Sex|         Weapon_Desc|Weapon_Used_Cd|                 _id|\n+----+-----------+------+--------+--------+--------+--------------------+------------+--------------------+---------+--------------------+-------+--------------------+---------+--------------------+--------+---------+--------------------+-----------+------+------------+--------+--------+------------+--------+--------------------+--------------+--------------------+\n|   3|  Southwest|   510|     510|    null|    null|    VEHICLE - STOLEN|        null|08/02/2020 12:00:...|200315229|08/04/2020 12:00:...|34.0317|1100 W  ADAMS    ...| -118.284|                null|       1|      101|              STREET|        327|    IC| Invest Cont|    2330|       0|        null|    null|                null|          null|[6800a2a9d4591795...|\n|  10|West Valley|   740|     740|    null|    null|VANDALISM - FELON...|        null|10/29/2020 12:00:...|201014559|10/29/2020 12:00:...|34.1866|6400    WILBUR   ...|-118.5447|0913 1414 0329 02...|       2|      122|VEHICLE, PASSENGE...|       1033|    AO| Adult Other|    2220|      25|           H|       F|            CLUB/BAT|           304|[6800a2a9d4591795...|\n|   3|  Southwest|   624|     624|    null|    null|BATTERY - SIMPLE ...|        null|06/18/2020 12:00:...|200312874|06/18/2020 12:00:...|34.0132|1000    LEIGHTON ...|-118.2915|0329 0400 0416 09...|       2|      502|MULTI-UNIT DWELLI...|        379|    IC| Invest Cont|     940|      21|           B|       F|STRONG-ARM (HANDS...|           400|[6800a2a9d4591795...|\n|  13|     Newton|   341|     341|     998|    null|THEFT-GRAND ($950...|        null|03/15/2020 12:00:...|201308208|03/15/2020 12:00:...|34.0279|1300    NEWTON   ...| -118.247|      1402 0344 0329|       1|      721|         HIGH SCHOOL|       1317|    AA|Adult Arrest|    2337|       0|           H|       M|                null|          null|[6800a2a9d4591795...|\n|   8|    West LA|   420|     420|    null|    null|THEFT FROM MOTOR ...|        null|06/12/2020 12:00:...|200810741|06/17/2020 12:00:...| 34.089|1100    ANGELO   ...|  -118.43|      1822 0344 0385|       1|      101|              STREET|        807|    IC| Invest Cont|    2130|      24|           W|       F|                null|          null|[6800a2a9d4591795...|\n+----+-----------+------+--------+--------+--------+--------------------+------------+--------------------+---------+--------------------+-------+--------------------+---------+--------------------+--------+---------+--------------------+-----------+------+------------+--------+--------+------------+--------+--------------------+--------------+--------------------+\nonly showing top 5 rows\n\r\nmongoDF: org.apache.spark.sql.DataFrame = [AREA: int, AREA NAME: string ... 26 more fields]\r\nrenamedDF: org.apache.spark.sql.DataFrame = [AREA: int, AREA_NAME: string ... 26 more fields]\r\ndf: org.apache.spark.sql.DataFrame = [AREA: int, AREA_NAME: string ... 26 more fields]\n"}]},"apps":[],"jobName":"paragraph_1744872539395_-1635715279","id":"20250417-024859_1299342406","dateCreated":"2025-04-17T02:48:59-0400","dateStarted":"2025-04-24T11:32:04-0400","dateFinished":"2025-04-24T11:36:08-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:356"},{"text":"df.printSchema()","user":"anonymous","dateUpdated":"2025-04-24T11:32:09-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- AREA: integer (nullable = true)\n |-- AREA_NAME: string (nullable = true)\n |-- Crm_Cd: integer (nullable = true)\n |-- Crm_Cd_1: integer (nullable = true)\n |-- Crm_Cd_2: integer (nullable = true)\n |-- Crm_Cd_3: integer (nullable = true)\n |-- Crm_Cd_Desc: string (nullable = true)\n |-- Cross_Street: string (nullable = true)\n |-- DATE_OCC: string (nullable = true)\n |-- DR_NO: integer (nullable = true)\n |-- Date_Rptd: string (nullable = true)\n |-- LAT: double (nullable = true)\n |-- LOCATION: string (nullable = true)\n |-- LON: double (nullable = true)\n |-- Mocodes: string (nullable = true)\n |-- Part_1-2: integer (nullable = true)\n |-- Premis_Cd: integer (nullable = true)\n |-- Premis_Desc: string (nullable = true)\n |-- Rpt_Dist_No: integer (nullable = true)\n |-- Status: string (nullable = true)\n |-- Status_Desc: string (nullable = true)\n |-- TIME_OCC: integer (nullable = true)\n |-- Vict_Age: integer (nullable = true)\n |-- Vict_Descent: string (nullable = true)\n |-- Vict_Sex: string (nullable = true)\n |-- Weapon_Desc: string (nullable = true)\n |-- Weapon_Used_Cd: integer (nullable = true)\n |-- _id: struct (nullable = true)\n |    |-- oid: string (nullable = true)\n\r\n"}]},"apps":[],"jobName":"paragraph_1744872539064_-1150385205","id":"20250417-024859_1886016590","dateCreated":"2025-04-17T02:48:59-0400","dateStarted":"2025-04-24T11:32:34-0400","dateFinished":"2025-04-24T11:36:10-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:357"},{"text":"// TEMPORAL ANALYSIS\n\n\nval temporalDF = df\n  // Convert date columns to actual date types (DATE_OCC is our primary date field)\n  .withColumn(\"DATE_OCC_PARSED\", to_timestamp($\"DATE_OCC\", \"MM/dd/yyyy HH:mm:ss\"))\n  // Extract temporal components\n  .withColumn(\"HOUR\", hour($\"DATE_OCC_PARSED\"))\n  .withColumn(\"DAY_OF_WEEK\", date_format($\"DATE_OCC_PARSED\", \"EEEE\"))\n  .withColumn(\"MONTH\", month($\"DATE_OCC_PARSED\"))\n  .withColumn(\"MONTH_NAME\", date_format($\"DATE_OCC_PARSED\", \"MMMM\"))\n  .withColumn(\"YEAR\", year($\"DATE_OCC_PARSED\"))\n  .withColumn(\"TIME_PERIOD\",\n  when($\"TIME_OCC\" >= 0 && $\"TIME_OCC\" < 1200, \"Morning (12am-11:59am)\")\n  .when($\"TIME_OCC\" >= 1200 && $\"TIME_OCC\" < 1700, \"Afternoon (12pm-4:59pm)\")\n  .when($\"TIME_OCC\" >= 1700 && $\"TIME_OCC\" <= 2359, \"Evening (5pm-11:59pm)\")\n  .otherwise(\"Unknown\"))\n  .withColumn(\"SEASON\", \n    when($\"MONTH\".isin(3, 4, 5), \"Spring\")\n    .when($\"MONTH\".isin(6, 7, 8), \"Summer\")\n    .when($\"MONTH\".isin(9, 10, 11), \"Fall\")\n    .when($\"MONTH\".isin(12, 1, 2), \"Winter\")\n    .otherwise(\"Unknown\"))","user":"anonymous","dateUpdated":"2025-04-24T11:32:15-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"temporalDF: org.apache.spark.sql.DataFrame = [AREA: int, AREA_NAME: string ... 34 more fields]\n"}]},"apps":[],"jobName":"paragraph_1744872537816_1262478144","id":"20250417-024857_922814623","dateCreated":"2025-04-17T02:48:57-0400","dateStarted":"2025-04-24T11:36:09-0400","dateFinished":"2025-04-24T11:36:12-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:358"},{"text":"// Cache the dataframe for better performance\ntemporalDF.cache()\n\n// Register as temp view for SQL queries\ntemporalDF.createOrReplaceTempView(\"crimes\")\n\n// Display basic dataset info\nprintln(\"Total records: \" + temporalDF.count())","user":"anonymous","dateUpdated":"2025-04-24T11:32:20-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Total records: 1005199\r\n"}]},"apps":[],"jobName":"paragraph_1744871611112_-401970040","id":"20250417-023331_1281580489","dateCreated":"2025-04-17T02:33:31-0400","dateStarted":"2025-04-24T11:36:10-0400","dateFinished":"2025-04-24T11:36:45-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:359"},{"text":"// 1. Modify hourly analysis to focus on TIME_OCC instead\r\nprintln(\"=== Crime Distribution by TIME_OCC ===\")\r\nval timeDistribution = temporalDF\r\n  .groupBy(\"TIME_OCC\")  // Use the actual TIME_OCC field\r\n  .count()\r\n  .orderBy($\"count\".desc)\r\n\r\ntimeDistribution.show(20)  // Show top 20 times\r\n\r\n// 2. Day of week distribution remains relevant\r\nprintln(\"=== Crime Distribution by Day of Week ===\")\r\nval dowDistribution = temporalDF\r\n  .groupBy(\"DAY_OF_WEEK\")\r\n  .count()\r\n  .withColumn(\"dow_order\", \r\n    when($\"DAY_OF_WEEK\" === \"Sunday\", 1)\r\n    .when($\"DAY_OF_WEEK\" === \"Monday\", 2)\r\n    .when($\"DAY_OF_WEEK\" === \"Tuesday\", 3)\r\n    .when($\"DAY_OF_WEEK\" === \"Wednesday\", 4)\r\n    .when($\"DAY_OF_WEEK\" === \"Thursday\", 5)\r\n    .when($\"DAY_OF_WEEK\" === \"Friday\", 6)\r\n    .when($\"DAY_OF_WEEK\" === \"Saturday\", 7)\r\n    .otherwise(0))\r\n  .orderBy(\"dow_order\")\r\n\r\ndowDistribution.show(7)\r\n\r\n// 3. For time periods, create periods based on actual TIME_OCC values\r\nprintln(\"=== Crime Distribution by Time Period ===\")\r\nval timePeriodDistribution = temporalDF\r\n  .withColumn(\"TIME_PERIOD\", \r\n    when($\"TIME_OCC\" >= 0 && $\"TIME_OCC\" < 600, \"Night (12am-6am)\")\r\n    .when($\"TIME_OCC\" >= 600 && $\"TIME_OCC\" < 1200, \"Morning (6am-12pm)\")\r\n    .when($\"TIME_OCC\" >= 1200 && $\"TIME_OCC\" < 1800, \"Afternoon (12pm-6pm)\")\r\n    .when($\"TIME_OCC\" >= 1800 && $\"TIME_OCC\" < 2400, \"Evening (6pm-12am)\")\r\n    .otherwise(\"Unknown\"))\r\n  .groupBy(\"TIME_PERIOD\")\r\n  .count()\r\n  .orderBy($\"count\".desc)\r\n\r\ntimePeriodDistribution.show(5)\r\n\r\n// 4. For day and time analysis, use actual TIME_OCC values\r\nprintln(\"=== Crime Patterns: Day of Week vs Time Periods ===\")\r\nval dayTimePeriodAnalysis = temporalDF\r\n  .withColumn(\"TIME_PERIOD\", \r\n    when($\"TIME_OCC\" >= 0 && $\"TIME_OCC\" < 600, \"Night (12am-6am)\")\r\n    .when($\"TIME_OCC\" >= 600 && $\"TIME_OCC\" < 1200, \"Morning (6am-12pm)\")\r\n    .when($\"TIME_OCC\" >= 1200 && $\"TIME_OCC\" < 1800, \"Afternoon (12pm-6pm)\")\r\n    .when($\"TIME_OCC\" >= 1800 && $\"TIME_OCC\" < 2400, \"Evening (6pm-12am)\")\r\n    .otherwise(\"Unknown\"))\r\n  .groupBy(\"DAY_OF_WEEK\", \"TIME_PERIOD\")\r\n  .count()\r\n  .orderBy($\"DAY_OF_WEEK\", $\"count\".desc)\r\n\r\ndayTimePeriodAnalysis.show(28) // 7 days * 4 periods","user":"anonymous","dateUpdated":"2025-04-24T11:32:26-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"=== Crime Distribution by TIME_OCC ===\r\n+--------+-----+\n|TIME_OCC|count|\n+--------+-----+\n|    1200|35215|\n|    1800|26579|\n|    1700|25198|\n|    2000|24780|\n|    1900|23083|\n|    2200|22878|\n|    2100|21884|\n|    1600|20828|\n|    1500|20229|\n|    1400|17805|\n|       1|17366|\n|    2300|17248|\n|    1000|16730|\n|     800|16625|\n|    1300|15715|\n|    1100|14511|\n|     900|14087|\n|     100|11455|\n|    1830|11142|\n|    1730|10740|\n+--------+-----+\nonly showing top 20 rows\n\r\n=== Crime Distribution by Day of Week ===\r\n+-----------+------+---------+\n|DAY_OF_WEEK| count|dow_order|\n+-----------+------+---------+\n|     Sunday|139662|        1|\n|     Monday|141567|        2|\n|    Tuesday|138163|        3|\n|  Wednesday|142756|        4|\n|   Thursday|141861|        5|\n|     Friday|153716|        6|\n|   Saturday|147474|        7|\n+-----------+------+---------+\n\r\n=== Crime Distribution by Time Period ===\r\n+--------------------+------+\n|         TIME_PERIOD| count|\n+--------------------+------+\n|Afternoon (12pm-6pm)|327406|\n|  Evening (6pm-12am)|314140|\n|  Morning (6am-12pm)|209949|\n|    Night (12am-6am)|153704|\n+--------------------+------+\n\r\n=== Crime Patterns: Day of Week vs Time Periods ===\r\n+-----------+--------------------+-----+\n|DAY_OF_WEEK|         TIME_PERIOD|count|\n+-----------+--------------------+-----+\n|     Friday|Afternoon (12pm-6pm)|51754|\n|     Friday|  Evening (6pm-12am)|49523|\n|     Friday|  Morning (6am-12pm)|31515|\n|     Friday|    Night (12am-6am)|20924|\n|     Monday|Afternoon (12pm-6pm)|46345|\n|     Monday|  Evening (6pm-12am)|42470|\n|     Monday|  Morning (6am-12pm)|31224|\n|     Monday|    Night (12am-6am)|21528|\n|   Saturday|  Evening (6pm-12am)|47683|\n|   Saturday|Afternoon (12pm-6pm)|45972|\n|   Saturday|  Morning (6am-12pm)|28381|\n|   Saturday|    Night (12am-6am)|25438|\n|     Sunday|  Evening (6pm-12am)|43876|\n|     Sunday|Afternoon (12pm-6pm)|42622|\n|     Sunday|    Night (12am-6am)|27021|\n|     Sunday|  Morning (6am-12pm)|26143|\n|   Thursday|Afternoon (12pm-6pm)|46881|\n|   Thursday|  Evening (6pm-12am)|44126|\n|   Thursday|  Morning (6am-12pm)|30755|\n|   Thursday|    Night (12am-6am)|20099|\n|    Tuesday|Afternoon (12pm-6pm)|46033|\n|    Tuesday|  Evening (6pm-12am)|42581|\n|    Tuesday|  Morning (6am-12pm)|30394|\n|    Tuesday|    Night (12am-6am)|19155|\n|  Wednesday|Afternoon (12pm-6pm)|47799|\n|  Wednesday|  Evening (6pm-12am)|43881|\n|  Wednesday|  Morning (6am-12pm)|31537|\n|  Wednesday|    Night (12am-6am)|19539|\n+-----------+--------------------+-----+\n\r\ntimeDistribution: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [TIME_OCC: int, count: bigint]\r\ndowDistribution: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [DAY_OF_WEEK: string, count: bigint ... 1 more field]\r\ntimePeriodDistribution: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [TIME_PERIOD: string, count: bigint]\r\ndayTimePeriodAnalysis: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [DAY_OF_WEEK: string, TIME_PERIOD: string ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1745118863422_1886261646","id":"20250419-231423_80030118","dateCreated":"2025-04-19T23:14:23-0400","dateStarted":"2025-04-24T11:36:13-0400","dateFinished":"2025-04-24T11:36:58-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:360"},{"text":"%sql\r\n-- Crime Distribution by Day of Week (for better visualization)\r\nSELECT \r\n  DAY_OF_WEEK,\r\n  COUNT(*) as crime_count\r\nFROM crimes\r\nGROUP BY DAY_OF_WEEK\r\nORDER BY \r\n  CASE \r\n    WHEN DAY_OF_WEEK = 'Sunday' THEN 1\r\n    WHEN DAY_OF_WEEK = 'Monday' THEN 2\r\n    WHEN DAY_OF_WEEK = 'Tuesday' THEN 3\r\n    WHEN DAY_OF_WEEK = 'Wednesday' THEN 4\r\n    WHEN DAY_OF_WEEK = 'Thursday' THEN 5\r\n    WHEN DAY_OF_WEEK = 'Friday' THEN 6\r\n    WHEN DAY_OF_WEEK = 'Saturday' THEN 7\r\n  END","user":"anonymous","dateUpdated":"2025-04-24T11:32:31-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":551.45,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"DAY_OF_WEEK":"string","crime_count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"DAY_OF_WEEK","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"crime_count","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":87.7333,"optionOpen":false}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"DAY_OF_WEEK\tcrime_count\nSunday\t139662\nMonday\t141567\nTuesday\t138163\nWednesday\t142756\nThursday\t141861\nFriday\t153716\nSaturday\t147474\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1745118880872_-1823609896","id":"20250419-231440_1730052977","dateCreated":"2025-04-19T23:14:40-0400","dateStarted":"2025-04-24T11:36:45-0400","dateFinished":"2025-04-24T11:37:00-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:361"},{"text":"%sql\r\n-- Monthly crime patterns for visualization\r\nSELECT\r\n  MONTH_NAME,\r\n  COUNT(*) as crime_count\r\nFROM crimes\r\nGROUP BY MONTH_NAME\r\nORDER BY\r\n  CASE \r\n    WHEN MONTH_NAME = 'January' THEN 1\r\n    WHEN MONTH_NAME = 'February' THEN 2\r\n    WHEN MONTH_NAME = 'March' THEN 3\r\n    WHEN MONTH_NAME = 'April' THEN 4\r\n    WHEN MONTH_NAME = 'May' THEN 5\r\n    WHEN MONTH_NAME = 'June' THEN 6\r\n    WHEN MONTH_NAME = 'July' THEN 7\r\n    WHEN MONTH_NAME = 'August' THEN 8\r\n    WHEN MONTH_NAME = 'September' THEN 9\r\n    WHEN MONTH_NAME = 'October' THEN 10\r\n    WHEN MONTH_NAME = 'November' THEN 11\r\n    WHEN MONTH_NAME = 'December' THEN 12\r\n  END","user":"anonymous","dateUpdated":"2025-04-24T11:32:47-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":527.183,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"MONTH_NAME":"string","crime_count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"MONTH_NAME","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"crime_count","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":97.733,"optionOpen":false}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"MONTH_NAME\tcrime_count\nJanuary\t92776\nFebruary\t86490\nMarch\t87862\nApril\t83518\nMay\t83014\nJune\t81383\nJuly\t83962\nAugust\t83850\nSeptember\t81015\nOctober\t84128\nNovember\t78977\nDecember\t78224\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1745118880262_-435316796","id":"20250419-231440_1165958784","dateCreated":"2025-04-19T23:14:40-0400","dateStarted":"2025-04-24T11:36:59-0400","dateFinished":"2025-04-24T11:37:02-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:362"},{"text":"// 1. First, we need to prepare our data with geographic information\r\n// Assuming we have district information in our crime data\r\n\r\n// Group crime counts by district\r\nval districtCrimeCount = temporalDF\r\n  .groupBy(\"AREA\", \"AREA_NAME\")  // Using AREA and AREA_NAME from your dataset\r\n  .count()\r\n  .orderBy($\"count\".desc)\r\n\r\n// Show the results\r\nprintln(\"=== Crime Count by District ===\")\r\ndistrictCrimeCount.show(50)\r\n\r\n// 2. Register as a temp view for SQL visualization\r\ndistrictCrimeCount.createOrReplaceTempView(\"district_crimes\")","user":"anonymous","dateUpdated":"2025-04-24T11:32:50-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"=== Crime Count by District ===\r\n+----+-----------+-----+\n|AREA|  AREA_NAME|count|\n+----+-----------+-----+\n|   1|    Central|69673|\n|  12|77th Street|61762|\n|  14|    Pacific|59521|\n|   3|  Southwest|57512|\n|   6|  Hollywood|52430|\n|  15|N Hollywood|51107|\n|  20|    Olympic|50071|\n|  18|  Southeast|49941|\n|  13|     Newton|49181|\n|   7|   Wilshire|48240|\n|   2|    Rampart|46826|\n|   8|    West LA|45731|\n|  11|  Northeast|42962|\n|   9|   Van Nuys|42883|\n|  10|West Valley|42157|\n|  17| Devonshire|41766|\n|   5|     Harbor|41462|\n|  21|    Topanga|41376|\n|  19|    Mission|40365|\n|   4| Hollenbeck|37097|\n|  16|   Foothill|33136|\n+----+-----------+-----+\n\r\ndistrictCrimeCount: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [AREA: int, AREA_NAME: string ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1745118879681_1074409120","id":"20250419-231439_1856616990","dateCreated":"2025-04-19T23:14:39-0400","dateStarted":"2025-04-24T11:37:00-0400","dateFinished":"2025-04-24T11:37:06-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:363"},{"text":"//For example, saved from Spark as CSV\r\n//districtCrimeCount\r\n  //.coalesce(1) // optional: to save as a single CSV file\r\n  //.write\r\n  //.option(\"header\", \"true\")\r\n  //.csv(\"C:/Users/gmuece552-001/la_crime_by_district\")\r\n\r\n","user":"anonymous","dateUpdated":"2025-04-24T11:32:52-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1745118877996_-1616986349","id":"20250419-231437_1086143861","dateCreated":"2025-04-19T23:14:37-0400","dateStarted":"2025-04-24T11:37:02-0400","dateFinished":"2025-04-24T11:37:06-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:364"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1745118863239_-1687167608","id":"20250419-231423_1545169331","dateCreated":"2025-04-19T23:14:23-0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:365"},{"text":"val crimesByVictimDemo = temporalDF\r\n      .filter(col(\"Vict_Age\").isNotNull && col(\"Vict_Sex\").isNotNull)\r\n      .withColumn(\"age_group\", \r\n        when(col(\"Vict_Age\") < 18, \"Under 18\")\r\n         .when(col(\"Vict_Age\").between(18, 25), \"18-25\")\r\n         .when(col(\"Vict_Age\").between(26, 40), \"26-40\")\r\n         .when(col(\"Vict_Age\").between(41, 60), \"41-60\")\r\n         .when(col(\"Vict_Age\") > 60, \"Over 60\")\r\n         .otherwise(\"Unknown\"))\r\n      .groupBy(\"Crm_Cd_Desc\", \"age_group\", \"Vict_Sex\")\r\n      .count()\r\n      .orderBy(desc(\"count\"))\r\n    \r\n    println(\"Crime types by victim demographics (top 20):\")\r\n    crimesByVictimDemo.show(20, false)","user":"anonymous","dateUpdated":"2025-04-24T11:32:55-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Crime types by victim demographics (top 20):\r\n+-------------------------------------------------------+---------+--------+-----+\n|Crm_Cd_Desc                                            |age_group|Vict_Sex|count|\n+-------------------------------------------------------+---------+--------+-----+\n|INTIMATE PARTNER - SIMPLE ASSAULT                      |26-40    |F       |17779|\n|THEFT OF IDENTITY                                      |26-40    |F       |17102|\n|BURGLARY FROM VEHICLE                                  |26-40    |M       |17039|\n|SHOPLIFTING - PETTY THEFT ($950 & UNDER)               |Under 18 |X       |16561|\n|ASSAULT WITH DEADLY WEAPON, AGGRAVATED ASSAULT         |26-40    |M       |14572|\n|BATTERY - SIMPLE ASSAULT                               |26-40    |M       |13329|\n|BURGLARY FROM VEHICLE                                  |26-40    |F       |13168|\n|BATTERY - SIMPLE ASSAULT                               |41-60    |M       |12872|\n|BURGLARY                                               |Under 18 |X       |12407|\n|BATTERY - SIMPLE ASSAULT                               |26-40    |F       |11634|\n|ASSAULT WITH DEADLY WEAPON, AGGRAVATED ASSAULT         |41-60    |M       |11394|\n|BATTERY - SIMPLE ASSAULT                               |41-60    |F       |11015|\n|VANDALISM - FELONY ($400 & OVER, ALL CHURCH VANDALISMS)|Under 18 |X       |10626|\n|THEFT OF IDENTITY                                      |41-60    |F       |10228|\n|THEFT OF IDENTITY                                      |26-40    |M       |10170|\n|BURGLARY FROM VEHICLE                                  |41-60    |M       |10166|\n|THEFT PLAIN - PETTY ($950 & UNDER)                     |26-40    |M       |10140|\n|THEFT PLAIN - PETTY ($950 & UNDER)                     |26-40    |F       |9697 |\n|VANDALISM - FELONY ($400 & OVER, ALL CHURCH VANDALISMS)|26-40    |M       |9674 |\n|BURGLARY                                               |41-60    |M       |9111 |\n+-------------------------------------------------------+---------+--------+-----+\nonly showing top 20 rows\n\r\ncrimesByVictimDemo: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Crm_Cd_Desc: string, age_group: string ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1745118862817_-417509955","id":"20250419-231422_1345931077","dateCreated":"2025-04-19T23:14:22-0400","dateStarted":"2025-04-24T11:37:06-0400","dateFinished":"2025-04-24T11:37:10-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:366"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1745125071597_-2120094185","id":"20250420-005751_2073442161","dateCreated":"2025-04-20T00:57:51-0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:367"},{"text":"val overallDemographics = temporalDF\r\n      .filter(col(\"Vict_Age\").isNotNull && col(\"Vict_Sex\").isNotNull)\r\n      .withColumn(\"age_group\", \r\n        when(col(\"Vict_Age\") < 18, \"Under 18\")\r\n         .when(col(\"Vict_Age\").between(18, 25), \"18-25\")\r\n         .when(col(\"Vict_Age\").between(26, 40), \"26-40\")\r\n         .when(col(\"Vict_Age\").between(41, 60), \"41-60\")\r\n         .when(col(\"Vict_Age\") > 60, \"Over 60\")\r\n         .otherwise(\"Unknown\"))\r\n      .groupBy(\"age_group\", \"Vict_Sex\")\r\n      .count()\r\n      .withColumn(\"total\", sum(\"count\").over())\r\n      .withColumn(\"baseline_pct\", round(col(\"count\") * 100 / col(\"total\"), 2))\r\n    \r\n    println(\"\\nBaseline victim demographics distribution:\")\r\n    overallDemographics.show()","user":"anonymous","dateUpdated":"2025-04-24T11:32:59-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nBaseline victim demographics distribution:\r\n+---------+--------+------+------+------------+\n|age_group|Vict_Sex| count| total|baseline_pct|\n+---------+--------+------+------+------------+\n|    41-60|       X|   549|860418|        0.06|\n|    18-25|       M| 48558|860418|        5.64|\n|    26-40|       F|145461|860418|       16.91|\n|    26-40|       X|  1014|860418|        0.12|\n|    26-40|       H|    45|860418|        0.01|\n|    18-25|       F| 56921|860418|        6.62|\n|    41-60|       M|119969|860418|       13.94|\n| Under 18|       F| 18773|860418|        2.18|\n| Under 18|       -|     1|860418|         0.0|\n|  Over 60|       X|   162|860418|        0.02|\n|  Over 60|       M| 45159|860418|        5.25|\n|    18-25|       H|    23|860418|         0.0|\n| Under 18|       X| 87502|860418|       10.17|\n|    26-40|       M|146118|860418|       16.98|\n|  Over 60|       H|    11|860418|         0.0|\n|  Over 60|       F| 37470|860418|        4.35|\n|    18-25|       X|  8559|860418|        0.99|\n|    41-60|       F| 99975|860418|       11.62|\n| Under 18|       H|     4|860418|         0.0|\n|    41-60|       H|    31|860418|         0.0|\n+---------+--------+------+------+------------+\nonly showing top 20 rows\n\r\noverallDemographics: org.apache.spark.sql.DataFrame = [age_group: string, Vict_Sex: string ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1745118599063_1410018846","id":"20250419-230959_1435554180","dateCreated":"2025-04-19T23:09:59-0400","dateStarted":"2025-04-24T11:37:07-0400","dateFinished":"2025-04-24T11:37:13-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:368"},{"text":"// Find the top 10 crime types\r\n    val top10Crimes = temporalDF\r\n      .groupBy(\"Crm_Cd_Desc\")\r\n      .count()\r\n      .orderBy(desc(\"count\"))\r\n      .limit(10)\r\n    \r\n    println(\"\\nTop 10 crime types:\")\r\n    top10Crimes.show(false)","user":"anonymous","dateUpdated":"2025-04-24T11:33:01-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nTop 10 crime types:\r\n+-------------------------------------------------------+------+\n|Crm_Cd_Desc                                            |count |\n+-------------------------------------------------------+------+\n|VEHICLE - STOLEN                                       |115246|\n|BATTERY - SIMPLE ASSAULT                               |74848 |\n|BURGLARY FROM VEHICLE                                  |63518 |\n|THEFT OF IDENTITY                                      |62539 |\n|VANDALISM - FELONY ($400 & OVER, ALL CHURCH VANDALISMS)|61094 |\n|BURGLARY                                               |57879 |\n|THEFT PLAIN - PETTY ($950 & UNDER)                     |53723 |\n|ASSAULT WITH DEADLY WEAPON, AGGRAVATED ASSAULT         |53532 |\n|INTIMATE PARTNER - SIMPLE ASSAULT                      |46712 |\n|THEFT FROM MOTOR VEHICLE - PETTY ($950 & UNDER)        |41316 |\n+-------------------------------------------------------+------+\n\r\ntop10Crimes: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Crm_Cd_Desc: string, count: bigint]\n"}]},"apps":[],"jobName":"paragraph_1745118598584_616740105","id":"20250419-230958_1888328675","dateCreated":"2025-04-19T23:09:58-0400","dateStarted":"2025-04-24T11:37:11-0400","dateFinished":"2025-04-24T11:37:17-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:369"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1745508380836_1731981918","id":"20250424-112620_361590998","dateCreated":"2025-04-24T11:26:20-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2744","text":"// Create mappings for the demographic codes\r\n// Sex mapping\r\nval sexMapping = Map(\r\n  \"F\" -> \"Female\",\r\n  \"M\" -> \"Male\", \r\n  \"X\" -> \"Unknown\"\r\n)\r\n\r\n// Descent mapping\r\nval descentMapping = Map(\r\n  \"A\" -> \"Other Asian\",\r\n  \"B\" -> \"Black\",\r\n  \"C\" -> \"Chinese\",\r\n  \"D\" -> \"Cambodian\",\r\n  \"F\" -> \"Filipino\",\r\n  \"G\" -> \"Guamanian\",\r\n  \"H\" -> \"Hispanic/Latin/Mexican\",\r\n  \"I\" -> \"American Indian/Alaskan Native\",\r\n  \"J\" -> \"Japanese\",\r\n  \"K\" -> \"Korean\",\r\n  \"L\" -> \"Laotian\",\r\n  \"O\" -> \"Other\",\r\n  \"P\" -> \"Pacific Islander\",\r\n  \"S\" -> \"Samoan\",\r\n  \"U\" -> \"Hawaiian\",\r\n  \"V\" -> \"Vietnamese\",\r\n  \"W\" -> \"White\",\r\n  \"X\" -> \"Unknown\",\r\n  \"Z\" -> \"Asian Indian\"\r\n)\r\n\r\n// Create UDFs for mapping\r\nimport org.apache.spark.sql.functions.udf\r\nval sexMappingUDF = udf((code: String) => sexMapping.getOrElse(code, \"Unknown\"))\r\nval descentMappingUDF = udf((code: String) => descentMapping.getOrElse(code, \"Unknown\"))\r\n\r\n// Apply mappings to the DataFrame\r\nval demographicDF = temporalDF\r\n  .withColumn(\"Victim_Sex\", sexMappingUDF($\"Vict_Sex\"))\r\n  .withColumn(\"Victim_Descent\", descentMappingUDF($\"Vict_Descent\"))\r\n  .withColumn(\"Age_Group\", \r\n    when(col(\"Vict_Age\") < 18, \"Under 18\")\r\n    .when(col(\"Vict_Age\").between(18, 25), \"18-25\")\r\n    .when(col(\"Vict_Age\").between(26, 40), \"26-40\")\r\n    .when(col(\"Vict_Age\").between(41, 60), \"41-60\")\r\n    .when(col(\"Vict_Age\") > 60, \"Over 60\")\r\n    .otherwise(\"Unknown\"))\r\n\r\n// Create temporary view for SQL analysis\r\ndemographicDF.createOrReplaceTempView(\"demographic_crimes\")\r\n\r\n// District and Victim Sex analysis - CORRECTED SYNTAX\r\nval districtSexAnalysis = demographicDF\r\n  .groupBy(\"AREA_NAME\", \"Victim_Sex\")\r\n  .count()\r\n  .orderBy($\"AREA_NAME\", $\"count\".desc)\r\n\r\n// District and Victim Descent analysis - CORRECTED SYNTAX\r\nval districtDescentAnalysis = demographicDF\r\n  .groupBy(\"AREA_NAME\", \"Victim_Descent\")\r\n  .count()\r\n  .orderBy($\"AREA_NAME\", $\"count\".desc)\r\n\r\n// District and Victim Age Group analysis - CORRECTED SYNTAX\r\nval districtAgeAnalysis = demographicDF\r\n  .groupBy(\"AREA_NAME\", \"Age_Group\")\r\n  .count()\r\n  .orderBy($\"AREA_NAME\", $\"count\".desc)\r\n\r\n// Most common victim profiles by district - CORRECTED SYNTAX\r\nval victimProfileByDistrict = demographicDF\r\n  .groupBy(\"AREA_NAME\", \"Victim_Sex\", \"Victim_Descent\", \"Age_Group\")\r\n  .count()\r\n  .orderBy($\"AREA_NAME\", $\"count\".desc)\r\n\r\n// Display results\r\nprintln(\"=== Crime Distribution by District and Victim Sex ===\")\r\ndistrictSexAnalysis.show(20)\r\n\r\nprintln(\"=== Crime Distribution by District and Victim Descent ===\")\r\ndistrictDescentAnalysis.show(20)\r\n\r\nprintln(\"=== Crime Distribution by District and Victim Age Group ===\")\r\ndistrictAgeAnalysis.show(20)","dateUpdated":"2025-04-24T11:40:30-0400","dateFinished":"2025-04-24T11:40:39-0400","dateStarted":"2025-04-24T11:40:30-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"=== Crime Distribution by District and Victim Sex ===\r\n+-----------+----------+-----+\n|  AREA_NAME|Victim_Sex|count|\n+-----------+----------+-----+\n|77th Street|    Female|26854|\n|77th Street|      Male|19832|\n|77th Street|   Unknown|15076|\n|    Central|      Male|33634|\n|    Central|    Female|21346|\n|    Central|   Unknown|14693|\n| Devonshire|      Male|15271|\n| Devonshire|    Female|14259|\n| Devonshire|   Unknown|12236|\n|   Foothill|      Male|13973|\n|   Foothill|    Female|12286|\n|   Foothill|   Unknown| 6877|\n|     Harbor|    Female|15001|\n|     Harbor|      Male|13944|\n|     Harbor|   Unknown|12517|\n| Hollenbeck|      Male|13484|\n| Hollenbeck|    Female|12621|\n| Hollenbeck|   Unknown|10992|\n|  Hollywood|      Male|21889|\n|  Hollywood|    Female|17713|\n+-----------+----------+-----+\nonly showing top 20 rows\n\r\n=== Crime Distribution by District and Victim Descent ===\r\n+-----------+--------------------+-----+\n|  AREA_NAME|      Victim_Descent|count|\n+-----------+--------------------+-----+\n|77th Street|               Black|22995|\n|77th Street|Hispanic/Latin/Me...|20149|\n|77th Street|             Unknown|15294|\n|77th Street|               White| 1671|\n|77th Street|               Other| 1211|\n|77th Street|         Other Asian|  278|\n|77th Street|            Filipino|   38|\n|77th Street|American Indian/A...|   35|\n|77th Street|              Korean|   20|\n|77th Street|          Vietnamese|   17|\n|77th Street|             Chinese|   16|\n|77th Street|    Pacific Islander|   10|\n|77th Street|        Asian Indian|    6|\n|77th Street|           Cambodian|    6|\n|77th Street|             Laotian|    5|\n|77th Street|            Japanese|    5|\n|77th Street|            Hawaiian|    2|\n|77th Street|           Guamanian|    2|\n|77th Street|              Samoan|    2|\n|    Central|Hispanic/Latin/Me...|17789|\n+-----------+--------------------+-----+\nonly showing top 20 rows\n\r\n=== Crime Distribution by District and Victim Age Group ===\r\n+-----------+---------+-----+\n|  AREA_NAME|Age_Group|count|\n+-----------+---------+-----+\n|77th Street| Under 18|18195|\n|77th Street|    26-40|17674|\n|77th Street|    41-60|14021|\n|77th Street|    18-25| 7218|\n|77th Street|  Over 60| 4654|\n|    Central|    26-40|24113|\n|    Central| Under 18|18142|\n|    Central|    41-60|14522|\n|    Central|    18-25| 8758|\n|    Central|  Over 60| 4138|\n| Devonshire| Under 18|13743|\n| Devonshire|    26-40| 9920|\n| Devonshire|    41-60| 9440|\n| Devonshire|  Over 60| 4940|\n| Devonshire|    18-25| 3723|\n|   Foothill| Under 18| 9884|\n|   Foothill|    26-40| 8908|\n|   Foothill|    41-60| 8123|\n|   Foothill|    18-25| 3181|\n|   Foothill|  Over 60| 3040|\n+-----------+---------+-----+\nonly showing top 20 rows\n\r\nsexMapping: scala.collection.immutable.Map[String,String] = Map(F -> Female, M -> Male, X -> Unknown)\r\ndescentMapping: scala.collection.immutable.Map[String,String] = Map(X -> Unknown, J -> Japanese, U -> Hawaiian, F -> Filipino, A -> Other Asian, I -> American Indian/Alaskan Native, G -> Guamanian, V -> Vietnamese, L -> Laotian, B -> Black, P -> Pacific Islander, C -> Chinese, H -> Hispanic/Latin/Mexican, W -> White, K -> Korean, O -> Other, D -> Cambodian, Z -> Asian Indian, S -> Samoan)\r\nimport org.apache.spark.sql.functions.udf\r\nsexMappingUDF: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))\r\ndescentMappingUDF: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Som..."}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1745508379211_-1148405201","id":"20250424-112619_1666092638","dateCreated":"2025-04-24T11:26:19-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2600","text":"// Get top 5 victim descent counts per district\nprintln(\"=== Top 5 Victim Descent Types by District ===\")\n\n// First, create a table with crime counts by district and descent\nval descentByDistrict = demographicDF\n  .filter($\"Victim_Descent\" =!= \"Unknown\")\n  .groupBy(\"AREA_NAME\", \"Victim_Descent\")\n  .count()\n\n// Create a temporary view for SQL query\ndescentByDistrict.createOrReplaceTempView(\"descent_district_counts\")\n\n// Use SQL to get the top 5 per district\nspark.sql(\"\"\"\n  SELECT t.*\n  FROM (\n    SELECT \n      AREA_NAME, \n      Victim_Descent, \n      count,\n      DENSE_RANK() OVER (PARTITION BY AREA_NAME ORDER BY count DESC) as rank\n    FROM descent_district_counts\n  ) t\n  WHERE rank <= 5\n  ORDER BY AREA_NAME, rank\n\"\"\").show(1000, false) // false parameter prevents truncation of text","dateUpdated":"2025-04-24T11:56:06-0400","dateFinished":"2025-04-24T11:56:15-0400","dateStarted":"2025-04-24T11:56:06-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"=== Top 5 Victim Descent Types by District ===\r\n+-----------+----------------------+-----+----+\n|AREA_NAME  |Victim_Descent        |count|rank|\n+-----------+----------------------+-----+----+\n|77th Street|Black                 |22995|1   |\n|77th Street|Hispanic/Latin/Mexican|20149|2   |\n|77th Street|White                 |1671 |3   |\n|77th Street|Other                 |1211 |4   |\n|77th Street|Other Asian           |278  |5   |\n|Central    |Hispanic/Latin/Mexican|17789|1   |\n|Central    |Black                 |13516|2   |\n|Central    |White                 |12290|3   |\n|Central    |Other                 |5981 |4   |\n|Central    |Other Asian           |2061 |5   |\n|Devonshire |Hispanic/Latin/Mexican|10260|1   |\n|Devonshire |White                 |9961 |2   |\n|Devonshire |Other                 |4318 |3   |\n|Devonshire |Black                 |2549 |4   |\n|Devonshire |Other Asian           |1249 |5   |\n|Foothill   |Hispanic/Latin/Mexican|15145|1   |\n|Foothill   |White                 |5979 |2   |\n|Foothill   |Other                 |3110 |3   |\n|Foothill   |Black                 |1386 |4   |\n|Foothill   |Other Asian           |323  |5   |\n|Harbor     |Hispanic/Latin/Mexican|14746|1   |\n|Harbor     |White                 |6450 |2   |\n|Harbor     |Black                 |4059 |3   |\n|Harbor     |Other                 |2392 |4   |\n|Harbor     |Other Asian           |549  |5   |\n|Hollenbeck |Hispanic/Latin/Mexican|18835|1   |\n|Hollenbeck |White                 |3109 |2   |\n|Hollenbeck |Black                 |1439 |3   |\n|Hollenbeck |Other                 |804  |4   |\n|Hollenbeck |Other Asian           |433  |5   |\n|Hollywood  |White                 |16178|1   |\n|Hollywood  |Hispanic/Latin/Mexican|10193|2   |\n|Hollywood  |Black                 |6712 |3   |\n|Hollywood  |Other                 |4150 |4   |\n|Hollywood  |Other Asian           |1206 |5   |\n|Mission    |Hispanic/Latin/Mexican|20999|1   |\n|Mission    |White                 |4024 |2   |\n|Mission    |Other                 |2898 |3   |\n|Mission    |Black                 |1881 |4   |\n|Mission    |Other Asian           |554  |5   |\n|N Hollywood|White                 |15954|1   |\n|N Hollywood|Hispanic/Latin/Mexican|12141|2   |\n|N Hollywood|Other                 |8948 |3   |\n|N Hollywood|Black                 |4038 |4   |\n|N Hollywood|Other Asian           |620  |5   |\n|Newton     |Hispanic/Latin/Mexican|22763|1   |\n|Newton     |Black                 |7570 |2   |\n|Newton     |White                 |4502 |3   |\n|Newton     |Other                 |1398 |4   |\n|Newton     |Other Asian           |504  |5   |\n|Northeast  |Hispanic/Latin/Mexican|12554|1   |\n|Northeast  |White                 |11226|2   |\n|Northeast  |Other                 |2686 |3   |\n|Northeast  |Black                 |1729 |4   |\n|Northeast  |Other Asian           |914  |5   |\n|Olympic    |Hispanic/Latin/Mexican|15877|1   |\n|Olympic    |White                 |5201 |2   |\n|Olympic    |Black                 |5047 |3   |\n|Olympic    |Other                 |3535 |4   |\n|Olympic    |Other Asian           |2948 |5   |\n|Pacific    |White                 |20321|1   |\n|Pacific    |Hispanic/Latin/Mexican|8230 |2   |\n|Pacific    |Black                 |6140 |3   |\n|Pacific    |Other                 |5236 |4   |\n|Pacific    |Other Asian           |1640 |5   |\n|Rampart    |Hispanic/Latin/Mexican|17557|1   |\n|Rampart    |White                 |6346 |2   |\n|Rampart    |Black                 |5290 |3   |\n|Rampart    |Other                 |2398 |4   |\n|Rampart    |Other Asian           |949  |5   |\n|Southeast  |Hispanic/Latin/Mexican|18155|1   |\n|Southeast  |Black                 |16514|2   |\n|Southeast  |White                 |1052 |3   |\n|Southeast  |Other                 |634  |4   |\n|Southeast  |Other Asian           |177  |5   |\n|Southwest  |Black                 |16791|1   |\n|Southwest  |Hispanic/Latin/Mexican|15208|2   |\n|Southwest  |White                 |4834 |3   |\n|Southwest  |Other                 |2365 |4   |\n|Southwest  |Other Asian           |1315 |5   |\n|Topanga    |White                 |14657|1   |\n|Topanga    |Hispanic/Latin/Mexican|9304 |2   |\n|Topanga    |Other                 |4083 |3   |\n|Topanga    |Black                 |3066 |4   |\n|Topanga    |Other Asian           |972  |5   |\n|Van Nuys   |Hispanic/Latin/Mexican|12474|1   |\n|Van Nuys   |White                 |12092|2   |\n|Van Nuys   |Other                 |4457 |3   |\n|Van Nuys   |Black                 |3416 |4   |\n|Van Nuys   |Other Asian           |752  |5   |\n|West LA    |White                 |17881|1   |\n|West LA    |Other                 |5850 |2   |\n|West LA    |Hispanic/Latin/Mexican|4529 |3   |\n|West LA    |Black                 |2699 |4   |\n|West LA    |Other Asian           |1585 |5   |\n|West Valley|White                 |14464|1   |\n|West Valley|Hispanic/Latin/Mexican|11153|2   |\n|West Valley|Other                 |6826 |3   |\n|West Valley|Black                 |2564 |4   |\n|West Valley|Other Asian           |841  |5   |\n|Wilshire   |White                 |13259|1   |\n|Wilshire   |Hispanic/Latin/Mexican|8379 |2   |\n|Wilshire   |Black                 |6422 |3   |\n|Wilshire   |Other                 |4729 |4   |\n|Wilshire   |Other Asian           |1470 |5   |\n+-----------+----------------------+-----+----+\n\r\ndescentByDistrict: org.apache.spark.sql.DataFrame = [AREA_NAME: string, Victim_Descent: string ... 1 more field]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1745508378336_1890307128","id":"20250424-112618_1082782713","dateCreated":"2025-04-24T11:26:18-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2528","text":"val distinctDistrictCount = temporalDF.select(\"AREA_NAME\").distinct().count()\nprintln(s\"Number of distinct districts: $distinctDistrictCount\")","dateUpdated":"2025-04-24T11:57:28-0400","dateFinished":"2025-04-24T11:57:31-0400","dateStarted":"2025-04-24T11:57:28-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Number of distinct districts: 21\r\ndistinctDistrictCount: Long = 21\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1745508376883_-2146902480","id":"20250424-112616_752765149","dateCreated":"2025-04-24T11:26:16-0400","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2456"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1745508376588_2050040640","id":"20250424-112616_459061848","dateCreated":"2025-04-24T11:26:16-0400","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2384"},{"text":"\n","user":"anonymous","dateUpdated":"2025-04-19T23:16:27-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1745117360604_1638987988","id":"20250419-224920_1450935781","dateCreated":"2025-04-19T22:49:20-0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:370"},{"text":"\n","user":"anonymous","dateUpdated":"2025-04-19T23:16:35-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1745117361152_1732814391","id":"20250419-224921_612107080","dateCreated":"2025-04-19T22:49:21-0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:371"}],"name":"Project","id":"2KRSUCMU4","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}